bind_rows()           # 按行合并
rlang::last_trace()
binary <- c(
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_FEMGENPAIN.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_E4_PCOS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_OVARYCYST.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_E4_OVARDYS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_CD2_BENIGN_LEIOMYOMA_UTERI.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_CD2_LEIOMYOMA_ENDOMETRIOSIS_EXALLC.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R11_N14_ENDOMETRIOSIS_ASRM_STAGE1_2.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_ASRM_STAGE3_4.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_DEEP.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_RECTPVAGSEPT_VAGINA.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_OVARY.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_PELVICPERITONEUM.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_UTERUS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_NOS.csv",
)
binary <- binary %>%
lapply(read.csv) %>%  # 读取每个文件
bind_rows()           # 按行合并
binary <- c(
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_FEMGENPAIN.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_E4_PCOS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_OVARYCYST.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_E4_OVARDYS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_CD2_BENIGN_LEIOMYOMA_UTERI.csv",
)
binary <- binary %>%
lapply(read.csv) %>%  # 读取每个文件
bind_rows()           # 按行合并
# merge results
library(dplyr)
binary <- c(
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_FEMGENPAIN.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_E4_PCOS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_OVARYCYST.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_E4_OVARDYS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_CD2_BENIGN_LEIOMYOMA_UTERI.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_CD2_LEIOMYOMA_ENDOMETRIOSIS_EXALLC.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R11_N14_ENDOMETRIOSIS_ASRM_STAGE1_2.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_ASRM_STAGE3_4.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_DEEP.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_RECTPVAGSEPT_VAGINA.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_OVARY.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_PELVICPERITONEUM.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_UTERUS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_ENDOMETRIOSIS_NOS.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/Ever_had_same_sex_intercourse_female.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/Ever_had_same_sex_intercourse.csv",
"C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/Ever_had_same_sex_intercourse_male.csv"
)
binary <- binary %>%
lapply(read.csv) %>%  # 读取每个文件
bind_rows()           # 按行合并
rlang::last_trace()
binary <- binary %>%
lapply(read.csv) %>%  # 读取每个文件
bind_rows()           # 按行合并
binary <- binary %>%
lapply(read.csv) %>%  # 读取每个文件
bind_rows()           # 按行合并
log_res <- function(res) {
#IVW
res$`logb_Inverse variance weighted` <- 0.693 * res$`b_Inverse variance weighted`
res$`loglo_ci_Inverse variance weighted` <- 0.693 * res$`lo_ci_Inverse variance weighted`
res$`logup_ci_Inverse variance weighted` <- 0.693 * res$`up_ci_Inverse variance weighted`
res$`logor_Inverse variance weighted` <- exp(res$`logb_Inverse variance weighted`)
res$`logor_lci95_Inverse variance weighted` <- exp(res$`loglo_ci_Inverse variance weighted`)
res$`logor_uci95_Inverse variance weighted` <- exp(res$`logup_ci_Inverse variance weighted`)
res$`logBeta (95% CI)_Inverse variance weighted` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_Inverse variance weighted`,
res$`loglo_ci_Inverse variance weighted`,
res$`logup_ci_Inverse variance weighted`)
res$`logOR (95% CI)_Inverse variance weighted` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_Inverse variance weighted`,
res$`logor_lci95_Inverse variance weighted`,
res$`logor_uci95_Inverse variance weighted`)
res$`logb_MR Egger` <- 0.693 * res$`b_MR Egger`
res$`loglo_ci_MR Egger` <- 0.693 * res$`lo_ci_MR Egger`
res$`logup_ci_MR Egger` <- 0.693 * res$`up_ci_MR Egger`
res$`logor_MR Egger` <- exp(res$`logb_MR Egger`)
res$`logor_lci95_MR Egger` <- exp(res$`loglo_ci_MR Egger`)
res$`logor_uci95_MR Egger` <- exp(res$`logup_ci_MR Egger`)
res$`logBeta (95% CI)_MR Egger` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_MR Egger`,
res$`loglo_ci_MR Egger`,
res$`logup_ci_MR Egger`)
res$`logOR (95% CI)_MR Egger` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_MR Egger`,
res$`logor_lci95_MR Egger`,
res$`logor_uci95_MR Egger`)
res$`logb_Weighted median` <- 0.693 * res$`b_Weighted median`
res$`loglo_ci_Weighted median` <- 0.693 * res$`lo_ci_Weighted median`
res$`logup_ci_Weighted median` <- 0.693 * res$`up_ci_Weighted median`
res$`logor_Weighted median` <- exp(res$`logb_Weighted median`)
res$`logor_lci95_Weighted median` <- exp(res$`loglo_ci_Weighted median`)
res$`logor_uci95_Weighted median` <- exp(res$`logup_ci_Weighted median`)
res$`logBeta (95% CI)_Weighted median` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_Weighted median`,
res$`loglo_ci_Weighted median`,
res$`logup_ci_Weighted median`)
res$`logOR (95% CI)_Weighted median` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_Weighted median`,
res$`logor_lci95_Weighted median`,
res$`logor_uci95_Weighted median`)
res$`logb_Simple mode` <- 0.693 * res$`b_Simple mode`
res$`loglo_ci_Simple mode` <- 0.693 * res$`lo_ci_Simple mode`
res$`logup_ci_Simple mode` <- 0.693 * res$`up_ci_Simple mode`
res$`logor_Simple mode` <- exp(res$`logb_Simple mode`)
res$`logor_lci95_Simple mode` <- exp(res$`loglo_ci_Simple mode`)
res$`logor_uci95_Simple mode` <- exp(res$`logup_ci_Simple mode`)
res$`logBeta (95% CI)_Simple mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_Simple mode`,
res$`loglo_ci_Simple mode`,
res$`logup_ci_Simple mode`)
res$`logOR (95% CI)_Simple mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_Simple mode`,
res$`logor_lci95_Simple mode`,
res$`logor_uci95_Simple mode`)
res$`logb_Weighted mode` <- 0.693 * res$`b_Weighted mode`
res$`loglo_ci_Weighted mode` <- 0.693 * res$`lo_ci_Weighted mode`
res$`logup_ci_Weighted mode` <- 0.693 * res$`up_ci_Weighted mode`
res$`logor_Weighted mode` <- exp(res$`logb_Weighted mode`)
res$`logor_lci95_Weighted mode` <- exp(res$`loglo_ci_Weighted mode`)
res$`logor_uci95_Weighted mode` <- exp(res$`logup_ci_Weighted mode`)
res$`logBeta (95% CI)_Weighted mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_Weighted mode`,
res$`loglo_ci_Weighted mode`,
res$`logup_ci_Weighted mode`)
res$`logOR (95% CI)_Weighted mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_Weighted mode`,
res$`logor_lci95_Weighted mode`,
res$`logor_uci95_Weighted mode`)
res$`logb_MR_PRESSO` <- 0.693 * res$`b_MR_PRESSO`
res$`loglo_ci_MR_PRESSO` <- 0.693 * res$`lo_ci_MR_PRESSO`
res$`logup_ci_MR_PRESSO` <- 0.693 * res$`up_ci_MR_PRESSO`
res$`logor_MR_PRESSO` <- exp(res$`or_MR_PRESSO`)
res$`logor_lci95_MR_PRESSO` <- exp(res$`or_lci95_MR_PRESSO`)
res$`logor_uci95_MR_PRESSO` <- exp(res$`or_uci95_MR_PRESSO`)
res$`logBeta (95% CI)_Weighted mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_MR_PRESSO`,
res$`loglo_ci_MR_PRESSO`,
res$`logup_ci_MR_PRESSO`)
res$`logOR (95% CI)_Weighted mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_MR_PRESSO`,
res$`logor_lci95_MR_PRESSO`,
res$`logor_uci95_MR_PRESSO`)
return(res)
}
dat <- fread("C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_FEMGENPAIN_dat.csv")
dat <- fread("C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_FEMGENPAIN_dat.csv")
res <- U5_mr(
dat,
method_list = c("mr_wald_ratio", "mr_egger_regression", "mr_weighted_median", "mr_ivw",
"mr_simple_mode", "mr_weighted_mode"),
workers = 1,
run_mr_presso = TRUE,
NbDistribution = 4000
) %>%
log_res() %>%
U5_add_steiger(dat)
res <- U5_mr(
dat,
method_list = c("mr_wald_ratio", "mr_egger_regression", "mr_weighted_median", "mr_ivw",
"mr_simple_mode", "mr_weighted_mode"),
workers = 1,
run_mr_presso = FALSE,
NbDistribution = 4000
) %>%
log_res() %>%
U5_add_steiger(dat)
res <- U5_mr(
dat,
method_list = c("mr_wald_ratio", "mr_egger_regression", "mr_weighted_median", "mr_ivw",
"mr_simple_mode", "mr_weighted_mode"),
workers = 1,
run_mr_presso = FALSE,
NbDistribution = 4000
) %>%
log_res() %>%
U5_add_steiger(dat)
res <- U5_mr(
dat,
method_list = c("mr_wald_ratio", "mr_egger_regression", "mr_weighted_median", "mr_ivw",
"mr_simple_mode", "mr_weighted_mode"),
workers = 1,
run_mr_presso = FALSE,
NbDistribution = 4000
) %>%
log_res() %>%
U5_add_steiger(dat)
#IVW
res$`logb_Inverse variance weighted` <- 0.693 * res$`b_Inverse variance weighted`
res$`loglo_ci_Inverse variance weighted` <- 0.693 * res$`lo_ci_Inverse variance weighted`
res$`logup_ci_Inverse variance weighted` <- 0.693 * res$`up_ci_Inverse variance weighted`
res <- U5_mr(
dat,
method_list = c("mr_wald_ratio", "mr_egger_regression", "mr_weighted_median", "mr_ivw",
"mr_simple_mode", "mr_weighted_mode"),
workers = 1,
run_mr_presso = FALSE,
NbDistribution = 4000
) %>%
log_res() %>%
U5_add_steiger(dat)
dat <- fread("C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_FEMGENPAIN_dat.csv")
res <- U5_mr(
dat,
method_list = c("mr_wald_ratio", "mr_egger_regression", "mr_weighted_median", "mr_ivw",
"mr_simple_mode", "mr_weighted_mode"),
workers = 1,
run_mr_presso = TRUE,
NbDistribution = 1000
) %>%
log_res() %>%
U5_add_steiger(dat)
library(TwoSampleMR) #version 0.6.8
library(Oneclick) #version 5.3.0
library(mrfunctions) #version 0.6.8
library(readxl)
library(arrow)
library(data.table)
library(dplyr)
res <- U5_mr(
dat,
method_list = c("mr_wald_ratio", "mr_egger_regression", "mr_weighted_median", "mr_ivw",
"mr_simple_mode", "mr_weighted_mode"),
workers = 1,
run_mr_presso = TRUE,
NbDistribution = 1000
) %>%
log_res() %>%
U5_add_steiger(dat)
dat <- as.data.frame(dat)
res <- U5_mr(
dat,
method_list = c("mr_wald_ratio", "mr_egger_regression", "mr_weighted_median", "mr_ivw",
"mr_simple_mode", "mr_weighted_mode"),
workers = 1,
run_mr_presso = TRUE,
NbDistribution = 1000
) %>%
log_res() %>%
U5_add_steiger(dat)
View(res)
res$`logb_MR_PRESSO` <- 0.693 * res$`b_MR_PRESSO`
res$`loglo_ci_MR_PRESSO` <- 0.693 * res$`lo_ci_MR_PRESSO`
res$`logup_ci_MR_PRESSO` <- 0.693 * res$`up_ci_MR_PRESSO`
res$`logor_MR_PRESSO` <- exp(res$`or_MR_PRESSO`)
res$`logor_lci95_MR_PRESSO` <- exp(res$`or_lci95_MR_PRESSO`)
res$`logor_uci95_MR_PRESSO` <- exp(res$`or_uci95_MR_PRESSO`)
res$`logBeta (95% CI)_Weighted mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_MR_PRESSO`,
res$`loglo_ci_MR_PRESSO`,
res$`logup_ci_MR_PRESSO`)
res$`logOR (95% CI)_Weighted mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_MR_PRESSO`,
res$`logor_lci95_MR_PRESSO`,
res$`logor_uci95_MR_PRESSO`)
View(res)
res <- U5_mr(
dat,
method_list = c("mr_wald_ratio", "mr_egger_regression", "mr_weighted_median", "mr_ivw",
"mr_simple_mode", "mr_weighted_mode"),
workers = 1,
run_mr_presso = TRUE,
NbDistribution = 4000
) %>%
log_res() %>%
U5_add_steiger(dat)
res$`logb_MR_PRESSO` <- 0.693 * res$`b_MR_PRESSO`
res$`loglo_ci_MR_PRESSO` <- 0.693 * res$`lo_ci_MR_PRESSO`
res$`logup_ci_MR_PRESSO` <- 0.693 * res$`up_ci_MR_PRESSO`
res$`logor_MR_PRESSO` <- exp(res$`or_MR_PRESSO`)
res$`logor_lci95_MR_PRESSO` <- exp(res$`or_lci95_MR_PRESSO`)
res$`logor_uci95_MR_PRESSO` <- exp(res$`or_uci95_MR_PRESSO`)
res$`logBeta (95% CI)_Weighted mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_MR_PRESSO`,
res$`loglo_ci_MR_PRESSO`,
res$`logup_ci_MR_PRESSO`)
res$`logOR (95% CI)_Weighted mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_MR_PRESSO`,
res$`logor_lci95_MR_PRESSO`,
res$`logor_uci95_MR_PRESSO`)
View(res)
#remotes::install_github("gwendyun/mrfunctions",force = TRUE)
ao<-U1_get_ao(database="finngen_R12")
View(ao)
res <- fread("C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_CD2_BENIGN_LEIOMYOMA_UTERI.csv")
library(TwoSampleMR) #version 0.6.8
library(Oneclick) #version 5.3.0
remotes::install_github("gwendyun/mrfunctions",force = TRUE)
library(mrfunctions) #my own funtion
library(readxl)
library(arrow)
library(data.table)
library(dplyr)
res <- fread("C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_CD2_BENIGN_LEIOMYOMA_UTERI.csv")
nrol(res)
names(res)
# 指定要移动的列
cols_to_move <- c("outliers",
"Beta (95% CI)_MR_PRESSO",
"OR (95% CI)_MR_PRESSO",
"logb_MR_PRESSO",
"loglo_ci_MR_PRESSO",
"logup_ci_MR_PRESSO",
"logor_MR_PRESSO",
"logor_lci95_MR_PRESSO",
"logor_uci95_MR_PRESSO",
"PRESSO_Distortion_beta",
"PRESSO_Distortion_Pvalue")
# 重排列顺序，将指定列移动到最后
res <- res[, c(setdiff(names(res), cols_to_move), cols_to_move)]
# 查看调整后的数据框列顺序
print(names(res))
res <- fread("C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_CD2_BENIGN_LEIOMYOMA_UTERI.csv")
class(res)
# 指定要移动到最后的列
cols_to_move <- c("outliers",
"Beta (95% CI)_MR_PRESSO",
"OR (95% CI)_MR_PRESSO",
"logb_MR_PRESSO",
"loglo_ci_MR_PRESSO",
"logup_ci_MR_PRESSO",
"logor_MR_PRESSO",
"logor_lci95_MR_PRESSO",
"logor_uci95_MR_PRESSO",
"PRESSO_Distortion_beta",
"PRESSO_Distortion_Pvalue")
# 确保列名存在于 res 中
cols_to_move <- intersect(cols_to_move, names(res))
# 使用 setcolorder 调整列顺序
setcolorder(res, c(setdiff(names(res), cols_to_move), cols_to_move))
# 检查调整后的列顺序
print(names(res))
write.csv(res, "C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/res.csv", row.names = FALSE)
res <- fread("C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_FEMGENPAIN.csv")
# 指定需要调整顺序的列名
cols_to_move <- c("outliers",
"Beta (95% CI)_MR_PRESSO",
"OR (95% CI)_MR_PRESSO",
"logb_MR_PRESSO",
"loglo_ci_MR_PRESSO",
"logup_ci_MR_PRESSO",
"logor_MR_PRESSO",
"logor_lci95_MR_PRESSO",
"logor_uci95_MR_PRESSO",
"PRESSO_Distortion_beta",
"PRESSO_Distortion_Pvalue")
# 找出不存在的列，并创建这些列填充为 NA
missing_cols <- setdiff(cols_to_move, names(res))
if (length(missing_cols) > 0) {
for (col in missing_cols) {
res[[col]] <- NA
}
}
# 调整列顺序，将目标列移到最后
setcolorder(res, c(setdiff(names(res), cols_to_move), cols_to_move))
# 检查最终的列名顺序
print(names(res))
View(res)
res <- fread("C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_CD2_BENIGN_LEIOMYOMA_UTERI.csv")
# 指定需要调整顺序的列名
cols_to_move <- c("outliers",
"Beta (95% CI)_MR_PRESSO",
"OR (95% CI)_MR_PRESSO",
"logb_MR_PRESSO",
"loglo_ci_MR_PRESSO",
"logup_ci_MR_PRESSO",
"logor_MR_PRESSO",
"logor_lci95_MR_PRESSO",
"logor_uci95_MR_PRESSO",
"PRESSO_Distortion_beta",
"PRESSO_Distortion_Pvalue")
# 找出不存在的列，并创建这些列填充为 NA
missing_cols <- setdiff(cols_to_move, names(res))
if (length(missing_cols) > 0) {
for (col in missing_cols) {
res[[col]] <- NA
}
}
# 调整列顺序，将目标列移到最后
setcolorder(res, c(setdiff(names(res), cols_to_move), cols_to_move))
# 检查最终的列名顺序
print(names(res))
log_res <- function(res) {
#IVW
res$`logb_Inverse variance weighted` <- 0.693 * res$`b_Inverse variance weighted`
res$`loglo_ci_Inverse variance weighted` <- 0.693 * res$`lo_ci_Inverse variance weighted`
res$`logup_ci_Inverse variance weighted` <- 0.693 * res$`up_ci_Inverse variance weighted`
res$`logor_Inverse variance weighted` <- exp(res$`logb_Inverse variance weighted`)
res$`logor_lci95_Inverse variance weighted` <- exp(res$`loglo_ci_Inverse variance weighted`)
res$`logor_uci95_Inverse variance weighted` <- exp(res$`logup_ci_Inverse variance weighted`)
res$`logBeta (95% CI)_Inverse variance weighted` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_Inverse variance weighted`,
res$`loglo_ci_Inverse variance weighted`,
res$`logup_ci_Inverse variance weighted`)
res$`logOR (95% CI)_Inverse variance weighted` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_Inverse variance weighted`,
res$`logor_lci95_Inverse variance weighted`,
res$`logor_uci95_Inverse variance weighted`)
res$`logb_MR Egger` <- 0.693 * res$`b_MR Egger`
res$`loglo_ci_MR Egger` <- 0.693 * res$`lo_ci_MR Egger`
res$`logup_ci_MR Egger` <- 0.693 * res$`up_ci_MR Egger`
res$`logor_MR Egger` <- exp(res$`logb_MR Egger`)
res$`logor_lci95_MR Egger` <- exp(res$`loglo_ci_MR Egger`)
res$`logor_uci95_MR Egger` <- exp(res$`logup_ci_MR Egger`)
res$`logBeta (95% CI)_MR Egger` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_MR Egger`,
res$`loglo_ci_MR Egger`,
res$`logup_ci_MR Egger`)
res$`logOR (95% CI)_MR Egger` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_MR Egger`,
res$`logor_lci95_MR Egger`,
res$`logor_uci95_MR Egger`)
res$`logb_Weighted median` <- 0.693 * res$`b_Weighted median`
res$`loglo_ci_Weighted median` <- 0.693 * res$`lo_ci_Weighted median`
res$`logup_ci_Weighted median` <- 0.693 * res$`up_ci_Weighted median`
res$`logor_Weighted median` <- exp(res$`logb_Weighted median`)
res$`logor_lci95_Weighted median` <- exp(res$`loglo_ci_Weighted median`)
res$`logor_uci95_Weighted median` <- exp(res$`logup_ci_Weighted median`)
res$`logBeta (95% CI)_Weighted median` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_Weighted median`,
res$`loglo_ci_Weighted median`,
res$`logup_ci_Weighted median`)
res$`logOR (95% CI)_Weighted median` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_Weighted median`,
res$`logor_lci95_Weighted median`,
res$`logor_uci95_Weighted median`)
res$`logb_Simple mode` <- 0.693 * res$`b_Simple mode`
res$`loglo_ci_Simple mode` <- 0.693 * res$`lo_ci_Simple mode`
res$`logup_ci_Simple mode` <- 0.693 * res$`up_ci_Simple mode`
res$`logor_Simple mode` <- exp(res$`logb_Simple mode`)
res$`logor_lci95_Simple mode` <- exp(res$`loglo_ci_Simple mode`)
res$`logor_uci95_Simple mode` <- exp(res$`logup_ci_Simple mode`)
res$`logBeta (95% CI)_Simple mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_Simple mode`,
res$`loglo_ci_Simple mode`,
res$`logup_ci_Simple mode`)
res$`logOR (95% CI)_Simple mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_Simple mode`,
res$`logor_lci95_Simple mode`,
res$`logor_uci95_Simple mode`)
res$`logb_Weighted mode` <- 0.693 * res$`b_Weighted mode`
res$`loglo_ci_Weighted mode` <- 0.693 * res$`lo_ci_Weighted mode`
res$`logup_ci_Weighted mode` <- 0.693 * res$`up_ci_Weighted mode`
res$`logor_Weighted mode` <- exp(res$`logb_Weighted mode`)
res$`logor_lci95_Weighted mode` <- exp(res$`loglo_ci_Weighted mode`)
res$`logor_uci95_Weighted mode` <- exp(res$`logup_ci_Weighted mode`)
res$`logBeta (95% CI)_Weighted mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_Weighted mode`,
res$`loglo_ci_Weighted mode`,
res$`logup_ci_Weighted mode`)
res$`logOR (95% CI)_Weighted mode` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_Weighted mode`,
res$`logor_lci95_Weighted mode`,
res$`logor_uci95_Weighted mode`)
res$`logb_MR_PRESSO` <- 0.693 * res$`b_MR_PRESSO`
res$`loglo_ci_MR_PRESSO` <- 0.693 * res$`lo_ci_MR_PRESSO`
res$`logup_ci_MR_PRESSO` <- 0.693 * res$`up_ci_MR_PRESSO`
res$`logor_MR_PRESSO` <- exp(res$`or_MR_PRESSO`)
res$`logor_lci95_MR_PRESSO` <- exp(res$`or_lci95_MR_PRESSO`)
res$`logor_uci95_MR_PRESSO` <- exp(res$`or_uci95_MR_PRESSO`)
res$`logBeta (95% CI)_MR_PRESSO` <- sprintf("%.3f (%.3f to %.3f)",
res$`logb_MR_PRESSO`,
res$`loglo_ci_MR_PRESSO`,
res$`logup_ci_MR_PRESSO`)
res$`logOR (95% CI)_MR_PRESSO` <- sprintf("%.3f (%.3f to %.3f)",
res$`logor_MR_PRESSO`,
res$`logor_lci95_MR_PRESSO`,
res$`logor_uci95_MR_PRESSO`)
library(data.table)
# 指定需要调整顺序的列名
cols_to_move <- c("outliers",
"Beta (95% CI)_MR_PRESSO",
"OR (95% CI)_MR_PRESSO",
"logb_MR_PRESSO",
"loglo_ci_MR_PRESSO",
"logup_ci_MR_PRESSO",
"logor_MR_PRESSO",
"logor_lci95_MR_PRESSO",
"logor_uci95_MR_PRESSO",
"PRESSO_Distortion_beta",
"PRESSO_Distortion_Pvalue")
# 找出不存在的列，并创建这些列填充为 NA
missing_cols <- setdiff(cols_to_move, names(res))
if (length(missing_cols) > 0) {
for (col in missing_cols) {
res[[col]] <- NA
}
}
# 调整列顺序，将目标列移到最后
setcolorder(res, c(setdiff(names(res), cols_to_move), cols_to_move))
return(res)
}
res <- log_res(res)
View(res)
res <- fread("C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_N14_FEMGENPAIN.csv")
res<- log_res(res)
View(res)
res <- fread("C:/Users/hh24668/OneDrive - University of Bristol/projects/sleep_femrepro_association/finngen_R12_CD2_BENIGN_LEIOMYOMA_UTERI.csv")
res<- log_res(res)
View(res)
remotes::install_github("gwendyun/mrfunctions",force = TRUE)
detach("package:mrfunctions", unload = TRUE)
remove.packages("mrfunctions")
remotes::install_github("gwendyun/mrfunctions",force = TRUE)
library(mrfunctions)
